name: Notify Discord about Blog Posts

on: 
  workflow_dispatch:
  schedule:
    - cron: '* * * * *'

jobs: 
  notify-discord: 
    name: Notify Discord about latest blog posts
    runs-on: ubuntu-latest
    steps: 
      - name: Retrieve blog posts
        id: blog_posts
        uses: gautamkrishnar/blog-post-workflow@master
        with: 
          max_post_count: "1"
          feed_list: "https://derekhskim.medium.com/feed"
          output_only: true
      
      - name: Notify Discord
        run: |
          MESSAGE="ðŸ“¢ New Blog Post: ${steps.blog_posts.outputs.title} - ${steps.blog_posts.outputs.url}"
          curl -H "Content-Type: application/json" \
               -X POST \
               -d "{\"content\": \"$MESSAGE\"}" \
               ${{ secrets.DISCORD_WEBHOOK_URL }}
